<!doctype html>
<html amp lang="en">
  <head>
    <meta charset="utf-8">
    <base href="/">
    <title> Submitting a Microsoft Edge extension to the Microsoft Store ¬ª blog.tomayac.com </title>
    <meta name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1">
    <meta property="twitter:account_id" content="1510101733">
    <meta name="amp-google-client-id-api" content="googleanalytics">
    <link rel="shortcut icon" href="favicon.ico">
    <link rel="canonical" href="/takeout.php">
    <link rel="alternate" type="application/atom+xml" title="Blog von Thomas Steiner homoblogiens" href="./atom.php">
    <link type="text/plain" rel="author" href="https://tomayac.com/humans.txt">
    <style amp-boilerplate>body{-webkit-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-moz-animation:-amp-start 8s steps(1,end) 0s 1 normal both;-ms-animation:-amp-start 8s steps(1,end) 0s 1 normal both;animation:-amp-start 8s steps(1,end) 0s 1 normal both}@-webkit-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-moz-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-ms-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@-o-keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}@keyframes -amp-start{from{visibility:hidden}to{visibility:visible}}</style>
    <noscript>
      <style amp-boilerplate>body{-webkit-animation:none;-moz-animation:none;-ms-animation:none;animation:none}</style>
    </noscript>
    <style amp-custom>#header,
#navigation {
	background-color: #eee;
	margin: 0 0 .5em
}
#content,
#header {
	width: 100%;
	border: 1px dashed silver
}
#aside,
#content,
#footer,
#header,
#navigation {
	border: 1px dashed silver
}
#content a,
#footer a {
	padding: .2em;
	text-decoration: none
}
#aside a,
#content a,
#content>h3 a,
#footer a,
#navigation a {
	text-decoration: none
}
#aside a:hover,
#aside a:link,
#aside a:visited,
#content h2,
#content h3,
#content>h3 a,
#footer a,
body {
	color: #000
}
html {
	box-sizing: border-box
}
*,
::after,
::before {
	box-sizing: inherit
}
body {
	background-color: #fff;
	font-size: 12pt;
	font-family: "HelveticaNeue-Light", "Helvetica Neue Light", "Helvetica Neue", Helvetica, Arial, "Lucida Grande", sans-serif
}
#blog,
#ccasion {
	font-size: 1.5em;
	position: absolute;
	font-weight: 700
}
#blog {
	top: 0;
	left: 1em;
	z-index: 1;
	color: #ffd700
}
#ccasion {
	top: .05em;
	left: 2.12em;
	z-index: 2;
	color: #ff8032
}
#login {
	position: absolute;
	top: .05em;
	right: .5em
}
#header {
	font-size: 1.2em;
	max-width: 1400px;
	padding: 0;
	overflow: hidden
}
#aside h2,
#navigation h2 {
	font-size: .9em
}
#container {
	display: -webkit-flex;
	display: flex;
	margin: 0 .5em;
	max-width: calc(1400px - .5em)
}
@media (min-width: 480px) {
	#container {
		-webkit-flex-direction: row;
		flex-direction: row
	}
}
@media (max-width: 480px) {
	#container {
		-webkit-flex-direction: column;
		flex-direction: column
	}
}
#navigation-aside {
	display: -webkit-flex;
	display: flex
}
@media (min-width: 480px) {
	#navigation-aside {
		-webkit-flex-direction: column;
		flex-direction: column
	}
}
#navigation {
	width: 120px
}
#navigation h2 {
	margin: 0;
	background-color: #ffd700
}
#navigation a {
	display: block;
	overflow-x: hidden;
	padding: 0 0 .2em;
	font-weight: 700;
	color: #000
}
.category0:hover {
	background-color: #c0c0ff
}
.category1:hover {
	background-color: #ff8032
}
.category2:hover {
	background-color: #80ff00
}
.category3:hover {
	background-color: #ff0080
}
.category4:hover {
	background-color: #ff0
}
.category5:hover {
	background-color: #80ff80
}
.category6:hover {
	background-color: #ff8080
}
.category7:hover {
	background-color: #c0ff80
}
.category8:hover {
	background-color: #ffc080
}
#aside h2,
#content h2 {
	background-color: #ffd700;
	margin: 0
}
#aside a:hover,
#footer a:hover {
	background-color: #80ffff
}
#aside {
	width: 120px;
	margin: 0 .5em .5em 0;
	background-color: #eee;
	overflow-x: hidden
}
#aside svg {
	vertical-align: middle
}
#aside p {
	margin: .5em
}
#aside a {
	display: block;
	padding: 0;
	font-size: 1em;
	font-weight: 700
}
#content a,
#content h2,
#content h3,
#footer a {
	font-weight: 700
}
#content {
	margin: 0;
	text-align: justify
}
#content h2 {
	font-size: 1.2em
}
#content h3 {
	font-size: 1.1em;
	margin: 0;
	background-color: #ff8032
}
#content p {
	font-size: 1em;
	margin: .5em 0;
	text-align: justify
}
#content img {
	margin: .5em 1em
}
#content hr {
	height: 1px;
	text-align: left;
	margin-left: 0;
	border: 1px solid silver
}
#content small {
	font-size: .9em;
	padding: .5em 0
}
#content pre {
	font-family: monospace;
	color: #00f;
	background-color: #ffa;
	margin: 2.5em;
	font-size: .9em;
	white-space: pre-wrap;
	text-overflow: ellipsis;
	overflow-x: scroll
}
#content a {
	display: inline
}
#content a:link {
	color: #00f
}
#content a:visited {
	color: #00008b
}
#content a:hover {
	color: #00f;
	text-decoration: underline
}
#footer {
	max-width: 1400px;
	margin: .5em 0 0;
	padding: .5em
}
#footer ul {
	list-style: none
}
#footer li::before {
	content: "¬ª "
}
.blogPost {
	padding: .5em
}
.commentForm,
.commentList {
	display: none
}
ul {
	padding-left: .5em;
	list-style-position: inside
}
amp-iframe,
iframe {
	max-width: 533px
}
@media (max-width: 480px) {
	#navigation-aside {
		-webkit-flex-direction: row;
		flex-direction: row
	}
	#navigation {
		width: 50%
	}
	#aside>amp-img,
	#navigation amp-img {
		-webkit-transform-origin: left;
		-webkit-transform: scaleX(2);
		transform-origin: left;
		transform: scaleX(2)
	}
	#aside {
		width: 50%;
		margin: 0 0 .5em .5em
	}
	amp-iframe,
	amp-img,
	iframe,
	img {
		max-width: 100%;
		layout: responsive
	}
}</style>
    <script async src="https://cdn.ampproject.org/v0.js"></script>
    <script async custom-element="amp-iframe" src="https://cdn.ampproject.org/v0/amp-iframe-0.1.js"></script>
    <script async custom-element="amp-analytics" src="https://cdn.ampproject.org/v0/amp-analytics-0.1.js"></script>
    <script async custom-element="amp-youtube" src="https://cdn.ampproject.org/v0/amp-youtube-0.1.js"></script>
  </head>
  <body>
    <header id="header">
      <a href="/">
        <amp-img src="./static/img/city.jpg" alt="" width="1400" height="20"></amp-img>
      </a>
      <a href="/">
        <div id="blog">blog</div>
        <div id="ccasion">occasion</div>
      </a>
      &nbsp;<strong>l'occasion</strong> <em>f</em> - Gelegenheit <em>f</em>, die ~ , der ~; <em>bei Gelegenheit</em> - <strong>&agrave; l'occasion</strong>
    </header>
    <div id="container">
      <div id="navigation-aside">
        <nav id="navigation">
          <h2>Categories</h2>
          <a href="/">
            <amp-img src="./static/img/mountains_sunrise.jpg" alt="" width="120" height="23"></amp-img>
          </a>
          <a class='category0' href='categories/private/'>&nbsp;Private</a>
          <a class='category1' href='categories/work/'>&nbsp;Work</a>
          <a class='category2' href='categories/technical/'>&nbsp;Technical</a>
          <a class='category3' href='categories/political/'>&nbsp;Political</a>
          <a class='category4' href='categories/france/'>&nbsp;France</a>
        </nav>
        <aside id="aside">
          <h2>Related</h2>
          <amp-img src="./static/img/palms.jpg" alt="" width="120" height="23"></amp-img>
          <div>
            <p>
              <a href="atom.php" rel="me">
                <svg xmlns="http://www.w3.org/2000/svg" version="1.1" width="16" height="16" viewBox="0 0 256 256">
                  <rect width="246" height="246" rx="50" ry="50" x="5" y="5" fill="#F49C52"/>
                  <rect width="236" height="236" rx="47" ry="47" x="10" y="10" fill="#F49C52"/>
                  <circle cx="68" cy="189" r="24" fill="#FFF"/>
                  <path d="M160 213h-34a82 82 0 0 0-82-82v-34a116 116 0 0 1 116 116zM184 213A140 140 0 0 0 44 73V38a175 175 0 0 1 175 175z" fill="#FFF"/>
                </svg>
                Blog Feed
              </a>
            </p>
            <p>
              <a href="https://twitter.com/tomayac" rel="me">
                <svg xmlns="http://www.w3.org/2000/svg" xml:space="preserve" height="16" width="16" version="1.1" viewBox="0 0 182.7 150.7">
                  <defs>
                    <clipPath clipPathUnits="userSpaceOnUse">
                      <path d="m0 10h1366.9v1110.9h-1366.9z"/>
                    </clipPath>
                  </defs>
                  <g transform="matrix(1.3333 0 0 -1.3333 0 150.67)">
                    <g transform="scale(.1)">
                      <g clip-path="url(#clipPath20)">
                        <path d="m1366.9 989.4c-50.3-22.3-104.3-37.4-161-44.2 57.9 34.7 102.3 89.7 123.3 155.2-54.2-32.1-114.2-55.5-178.1-68-51.1 54.5-124 88.6-204.7 88.6-154.9 0-280.4-125.5-280.4-280.4 0-22 2.5-43.4 7.3-63.9-233.1 11.7-439.7 123.4-578 293-24.1-41.4-38-89.6-38-141 0-97.3 49.5-183.1 124.8-233.4-46 1.4-89.2 14.1-127 35.1 0-1.2 0-2.3 0-3.5 0-135.9 96.7-249.2 225-275-23.5-6.4-48.3-9.8-73.9-9.8-18.1 0-35.6 1.7-52.8 5 35.7-111.4 139.3-192.5 262-194.8-96.1-75.2-217-120-348.4-120-22.6 0-45 1.3-66.9 3.9 124.2-79.6 271.6-126 429.9-126 515.8 0 797.9 427.3 797.9 797.9 0 12.2-0.3 24.2-0.8 36.3 54.8 39.6 102.3 89 139.9 145.2" fill="#55ACEE"/>
                      </g>
                    </g>
                  </g>
                </svg>
                @tomayac
              </a>
            </p>
            <p>
              <a href="https://tomayac.com/tweets" rel="me">
                <svg xmlns="http://www.w3.org/2000/svg" xml:space="preserve" height="16" width="16" version="1.1" viewBox="0 0 182.7 150.7">
                  <defs>
                    <clipPath clipPathUnits="userSpaceOnUse">
                      <path d="m0 10h1366.9v1110.9h-1366.9z"/>
                    </clipPath>
                  </defs>
                  <g transform="matrix(1.3333 0 0 -1.3333 0 150.67)">
                    <g transform="scale(.1)">
                      <g clip-path="url(#clipPath20)">
                        <path d="m1366.9 989.4c-50.3-22.3-104.3-37.4-161-44.2 57.9 34.7 102.3 89.7 123.3 155.2-54.2-32.1-114.2-55.5-178.1-68-51.1 54.5-124 88.6-204.7 88.6-154.9 0-280.4-125.5-280.4-280.4 0-22 2.5-43.4 7.3-63.9-233.1 11.7-439.7 123.4-578 293-24.1-41.4-38-89.6-38-141 0-97.3 49.5-183.1 124.8-233.4-46 1.4-89.2 14.1-127 35.1 0-1.2 0-2.3 0-3.5 0-135.9 96.7-249.2 225-275-23.5-6.4-48.3-9.8-73.9-9.8-18.1 0-35.6 1.7-52.8 5 35.7-111.4 139.3-192.5 262-194.8-96.1-75.2-217-120-348.4-120-22.6 0-45 1.3-66.9 3.9 124.2-79.6 271.6-126 429.9-126 515.8 0 797.9 427.3 797.9 797.9 0 12.2-0.3 24.2-0.8 36.3 54.8 39.6 102.3 89 139.9 145.2" fill="#55ACEE"/>
                      </g>
                    </g>
                  </g>
                </svg>
                Tweet Archive
              </a>
            </p>
            <p>
              <a href="pgp_public_key.asc">üîê PGP Public Key</a>
            </p>
          </div>
        </aside>
      </div>
      <main id="content">
        <h2>A Look Inside the Think Tank...</h2>
        <wrapped>
  <p>This is a bit of a rant, and a bit of a process documentation. I'm trying to submit the <a href="https://github.com/google/service-worker-detector">Service Worker Detector</a> browser extension to the <a href="https://www.microsoft.com/en-us/store/b/home">Microsoft Store</a>, so it can be one of the <a href="https://www.microsoft.com/store/collections/edgeextensions/">Edge extensions</a> everyone can easily install via a few mouse clicks. I have to say, the process is somewhat involved.</p>

<p><amp-img layout="responsive" width="1200" height="675" src="./images/sw-detector-edge.jpg"></amp-img></p>

<p>To start, it's whitelist only, so you have to <a href="http://aka.ms/extension-request">apply via the extension submission form</a>, which I did. For me, nothing really happened for a long time, so I chased down someone from the helpful <a href="https://twitter.com/MSEdgeDev">@MSEdgeDev team</a> who pulled some internal strings. Ultimately I got an email invite that I may now submit to the Store. While you can <a href="https://docs.microsoft.com/en-us/microsoft-edge/extensions/guides/creating-an-extension">develop and test extensions locally</a> mostly the Chrome way (that I am quite familiar with) by just loading the extension in developer mode, the process gets more complex for the actual Store submission (and required testing):</p>
<ul>
  <li>First, you need to <a href="https://docs.microsoft.com/en-us/microsoft-edge/extensions/guides/packaging/using-manifoldjs-to-package-extensions">package the extension with ManifoldJS</a> so it becomes an app, so far so good.
    <pre><code>manifoldjs -l debug -p edgeextension -f edgeextension -m service-worker-detector/manifest.json
manifoldjs -l debug -p edgeextension package SWDetector/edgeextension/manifest/</code></pre></li>
  <li>Next, you need to <a href="https://docs.microsoft.com/en-us/microsoft-edge/extensions/guides/packaging/running-the-windows-app-certification-kit">test the resulting app package locally</a> with the <em>Windows App Certification Kit</em>, also no problem. I just went for the <a href="https://docs.microsoft.com/en-us/windows/uwp/debug-test-perf/windows-app-certification-kit#validate-your-windows-app-using-the-windows-app-certification-kit-from-a-command-line">interactive way</a> with the graphical user interface tool. This test caught an issue with icons, where the syntax <code>"browser_action": {"default_icon": "icon.png"}</code> or <code>"page_action": {"default_icon": "icon.png"}</code> would not work, but where <a href="https://docs.microsoft.com/en-us/microsoft-edge/extensions/api-support/supported-manifest-keys#browser_action-or-page_action-keys">explicit sizes are required</a> instead.</li>
  <li>Then, you need to <a href="https://docs.microsoft.com/en-us/windows/uwp/packaging/create-certificate-package-signing">create and export a self-signed certificate</a> (the CertStoreLocation parameter actually ends in just "My", it's not a typo):
    <pre><code>New-SelfSignedCertificate -Type Custom -Subject "CN=SUP3R-S3CRET-ID-TH1NG" -KeyUsage DigitalSignature -FriendlyName "Thomas Steiner" -CertStoreLocation "Cert:\LocalMachine\My"</code></pre>
    This returns a thumb ID that you need for the export step:
    <pre><code>$pwd = ConvertTo-SecureString -String mySecretPassword -Force -AsPlainText
Export-PfxCertificate -cert "Cert:\LocalMachine\My\SUP3RS3CR3TTHUMBPR1NT" -FilePath self-signed-certificate.pfx -Password $pwd</code></pre></li>
    <li>You need this certificate in order to <a href="https://docs.microsoft.com/en-us/windows/uwp/packaging/sign-app-package-using-signtool">sign your app package</a> created by ManifoldJS, which requires you to download and install the <a href="https://developer.microsoft.com/en-us/windows/downloads/windows-10-sdk">Windows 10 SDK</a> (and obviously an actual Windows 10 installation). Windows PowerShell would not recognize the installed SignTool, so I had to use the <a href="https://stackoverflow.com/questions/31869552/how-to-install-signtool-exe-for-windows-10">explicit path</a>:
      <pre><code>&amp; 'C:\Program Files (x86)\Windows Kits\10\bin\x64\signtool.exe' sign /fd SHA256 /a /f self-signed-certificate.pfx /p password edgeExtension.appx</code></pre></li>
  <li>Ultimately, you need to <a href="https://docs.microsoft.com/en-us/windows-hardware/drivers/devtest/certmgr">add the self-signed certificate to your trusted root certificates</a>, but it didn't work as described, so I ended up right-clicking the certificate file in Windows Explorer and fat-fingering around in the trust settings in the Details tab until it worked and I could install the Edge extension <code>.appx</code> file by double-clicking it.</li>
  </ul>

<p>I'm now in the third iteration with their store review team where it's all working fine for me locally, but where they say it crashes on their side. Let's see how it ends. I guess the core issue is that <a href="https://www.npmjs.com/package/manifoldjs">ManifoldJS</a> can do a lot of things to shield me from something, something <a href="https://en.wikipedia.org/wiki/Universal_Windows_Platform">Windows UWP apps</a>, but where eventually you still need to read the <a href="https://docs.microsoft.com/en-us/windows/uwp/packaging/">UWP packaging docs</a> for the Microsoft Store submission that are clearly not written with extension developers in mind, but rather for regular Windows app developers.</p>

<p><amp-img layout="responsive" width="1200" height="649" src="/images/sw-detector-store.jpg"></amp-img></p>

<p>Oh, and another thing I just realized: Edge <a href="https://caniuse.com/#feat=details">doesn't know</a> the <code>&lt;details&gt;</code> and <code>&lt;summary&gt;</code> elements. It <a href="https://developer.microsoft.com/en-us/microsoft-edge/platform/issues/13120279/">used to work</a> and <em>"[t]he implementation of this feature had shipped, but its quality was found lacking, hence this implementation was removed before Edge shipped last release. There currently [as of January 22, 2018] isn't [a] plan [Francois R. from the Microsoft Edge Team is] aware of to bring the feature back in the next update."</em> Sad. It is, however, mentioned as <em>Under Consideration</em> on the corresponding <a href="https://developer.microsoft.com/en-us/microsoft-edge/platform/status/detailssummary/?q=details">Edge Platform status page</a> with high priority, so here is hoping¬Ö</p>
<wrapped>

      </main>
    </div>
    <footer id="footer">
      <ul>
        <li>¬© 2005‚Äì2019 <a href="./">Thomas Steiner</a></li>
        <li>Distributed under <a rel="license" href="https://creativecommons.org/licenses/by-sa/4.0/">CC BY-SA 4.0</a></li>
        <li>Contact and required <a href="./2005/10/21/thomas-steiners-contact-data-180510">legal info</a></li>
        <li><small>This website uses Google Analytics</small></li>
      </ul>
      <amp-analytics type="googleanalytics">
        <script type="application/json">
          {
            "vars": {
              "account": "UA-2040927-1"
            },
            "triggers": {
              "defaultPageview": {
                "on": "visible",
                "request": "pageview"
              }
            }
          }
        </script>
      </amp-analytics>
    </footer>
  </body>
</html>
